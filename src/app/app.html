<div class="app-container">
  <header class="app-header">
    <div class="header-content">
      <h1 class="app-title">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="header-icon">
          <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
          <line x1="9" y1="3" x2="9" y2="21"></line>
        </svg>
        Kanban Task Manager
      </h1>
      <div style="display:flex; gap:8px; align-items:center;">
        <button class="add-task-btn" (click)="onAddTask()">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="12" y1="5" x2="12" y2="19"></line>
            <line x1="5" y1="12" x2="19" y2="12"></line>
          </svg>
          Add Task
        </button>
        <button class="add-task-btn" (click)="onAddColumn()">+ Column</button>
        <ng-container *ngIf="auth.currentUserEmail(); else loggedOut">
          <span style="color:#374151; font-weight:600;">{{ auth.currentUserEmail() }}</span>
          <button class="add-task-btn" (click)="logout()">Logout</button>
        </ng-container>
        <ng-template #loggedOut>
          <button class="add-task-btn" (click)="openAuth()">Login / Sign up</button>
        </ng-template>
      </div>
    </div>
  </header>

  <main class="app-main">
    <div class="kanban-board" cdkDropListGroup>
      <ng-container *ngFor="let col of taskService.columns()">
        <app-kanban-column
          [title]="col.title"
          [columnId]="col.id"
          [tasks]="getTasksForColumn(col.id)"
          [connectedIds]="getConnectedIds()"
          (reorder)="onReorder($event)"
          (moveToColumn)="onMoveToColumn($event)"
          (editTask)="onEditTask($event)"
          (deleteTask)="onDeleteTask($event)"
          (deleteColumn)="onDeleteColumn($event)"
        ></app-kanban-column>
      </ng-container>
    </div>
  </main>

  <app-task-form
    *ngIf="showTaskForm()"
    [task]="editingTask()"
    (saveTask)="onSaveTask($event)"
    (cancel)="onCancelForm()"
  ></app-task-form>

  <app-auth-modal *ngIf="showAuth()" (close)="closeAuth()"></app-auth-modal>
  <app-snackbar></app-snackbar>
</div>
